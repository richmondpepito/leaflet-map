<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Routes Map</title>

  <!-- Leaflet.js CDN for maps -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  
  <style>
    #map {
      height: 600px;
      width: 100%;
    }
  </style>
</head>
<body>

<h2>Routes from Cebu to Destinations</h2>
<div id="map"></div>

<script>
// Initialize the map
var map = L.map('map').setView([10.3157, 123.8854], 6);  // Default Cebu coordinates

// Set OpenStreetMap as the base layer
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);

// Function to fetch data from Google Sheets and plot routes
async function loadRoutes() {
  const sheetId = '1nluU05qQODaIe6-WP4hawC10awP94xwlO2hfspxBDy0'; // Replace with your actual sheet ID
  const apiKey = 'AIzaSyDuRPAa1M6SNEvcFqy0tLCjl3eZ0Go-9m0';   // No API Key needed here, this is for Sheets API only
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Sheet1?key=${apiKey}`;
  
  const response = await fetch(url);
  const data = await response.json();
  const rows = data.values.slice(1);  // Skip header

  // Loop through rows and create polylines
  rows.forEach(row => {
    const origin = [parseFloat(row[1]), parseFloat(row[2])];
    const destination = [parseFloat(row[3]), parseFloat(row[4])];
    
    // Create line (Polyline) between origin and destination
    L.polyline([origin, destination], {
      color: 'blue',
      weight: 4,
      opacity: 0.7
    }).addTo(map);

    // Mark the origin and destination with circles
    L.circleMarker(origin, { color: 'green', radius: 8 }).addTo(map).bindPopup('Origin: ' + row[0]);
    L.circleMarker(destination, { color: 'red', radius: 8 }).addTo(map).bindPopup('Destination: ' + row[0]);
  });
}

// Load routes from the Google Sheet
loadRoutes();
</script>

</body>
</html>
