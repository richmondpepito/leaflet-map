<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Warehouse Routes Map</title>
  <style>
    #map {
      height: 600px;
      width: 100%;
    }
    #filters {
      margin: 20px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div id="filters">
    <label for="warehouseTypeFilter">Warehouse Type: </label>
    <select id="warehouseTypeFilter">
      <option value="all">All Warehouse Types</option>
      <option value="Cebu Main">Cebu Main</option>
      <option value="Sub-warehouse">Sub-warehouse</option>
      <option value="Satellite Warehouse">Satellite Warehouse</option>
    </select>
    
    <label for="supervisorFilter">Supervisor: </label>
    <select id="supervisorFilter">
      <option value="all">All Supervisors</option>
      <option value="John Doe">John Doe</option>
      <option value="Jane Smith">Jane Smith</option>
      <option value="Mike Johnson">Mike Johnson</option>
    </select>
  </div>

  <div id="map"></div>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDuRPAa1M6SNEvcFqy0tLCjl3eZ0Go-9m0&callback=initMap" async defer></script>
  <script>
    var map;
    var routesData = [
      // Sample route data (replace with your own Google Sheets data)
      { routeID: "R001", originLat: 10.3157, originLong: 123.8854, destinationLat: 16.4023, destinationLong: 120.5960, routeType: "Cebu Main to Sub-warehouse", supervisor: "John Doe", warehouseType: "Cebu Main" },
      { routeID: "R002", originLat: 10.3157, originLong: 123.8854, destinationLat: 10.3118, destinationLong: 123.9180, routeType: "Cebu Main to Bin", supervisor: "Jane Smith", warehouseType: "Cebu Main" },
      { routeID: "R003", originLat: 10.3157, originLong: 123.8854, destinationLat: 7.1900, destinationLong: 125.4553, routeType: "Sub-warehouse to Satellite Warehouse", supervisor: "Mike Johnson", warehouseType: "Sub-warehouse" },
      { routeID: "R004", originLat: 9.3068, originLong: 124.6152, destinationLat: 7.1800, destinationLong: 125.4550, routeType: "Satellite Warehouse to Bin", supervisor: "Sarah Lee", warehouseType: "Satellite Warehouse" }
    ];

    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: { lat: 10.3157, lng: 123.8854 }, // Default center: Cebu Main
        zoom: 6
      });

      // Add event listeners to filters
      document.getElementById('warehouseTypeFilter').addEventListener('change', function() {
        var warehouseType = this.value;
        var supervisor = document.getElementById('supervisorFilter').value;
        updateMap(warehouseType, supervisor);
      });

      document.getElementById('supervisorFilter').addEventListener('change', function() {
        var supervisor = this.value;
        var warehouseType = document.getElementById('warehouseTypeFilter').value;
        updateMap(warehouseType, supervisor);
      });

      // Initial map render
      updateMap('all', 'all');
    }

    function updateMap(warehouseType, supervisor) {
      // Clear previous markers and lines
      clearMap();

      // Filter the data based on selected warehouseType and supervisor
      var filteredRoutes = routesData.filter(function(route) {
        var matchesWarehouseType = (warehouseType === 'all' || route.warehouseType === warehouseType);
        var matchesSupervisor = (supervisor === 'all' || route.supervisor === supervisor);
        return matchesWarehouseType && matchesSupervisor;
      });

      // Draw new routes on the map
      filteredRoutes.forEach(function(route) {
        drawRoute(route);
      });
    }

    function clearMap() {
      // Remove all markers and lines (you can add your code for clearing markers here)
      // In this simple example, we don't have markers stored globally, but you can extend this as needed.
    }

    function drawRoute(route) {
      var origin = new google.maps.LatLng(route.originLat, route.originLong);
      var destination = new google.maps.LatLng(route.destinationLat, route.destinationLong);
      
      // Define the route line style based on Route Type
      var lineOptions = {
        path: [origin, destination],
        geodesic: true,
        strokeColor: getRouteColor(route.routeType),
        strokeOpacity: 1.0,
        strokeWeight: getRouteWeight(route.routeType),
        icons: [{
          icon: {
            path: google.maps.SymbolPath.CIRCLE,
            scale: getMarkerSize(route.routeType),  // Adjust marker size based on route type
            strokeColor: getRouteColor(route.routeType),
          },
          offset: '100%',
        }]
      };

      var routeLine = new google.maps.Polyline(lineOptions);
      routeLine.setMap(map);

      // Add markers for origin and destination
      new google.maps.Marker({
        position: origin,
        map: map,
        title: route.originName,
      });
      
      new google.maps.Marker({
        position: destination,
        map: map,
        title: route.destinationName,
      });
    }

    // Helper functions for getting line color and weight based on Route Type
    function getRouteColor(routeType) {
      if (routeType.includes('Cebu Main to Sub-warehouse')) return 'black';
      if (routeType.includes('Cebu Main to Bin')) return 'black';
      if (routeType.includes('Sub-warehouse to Satellite Warehouse')) return 'blue';
      if (routeType.includes('Sub-warehouse to Bin')) return 'blue';
      if (routeType.includes('Satellite Warehouse to Bin')) return 'green';
      return 'gray';
    }

    function getRouteWeight(routeType) {
      if (routeType.includes('Cebu Main to Sub-warehouse')) return 4;  // Bold line
      if (routeType.includes('Cebu Main to Bin')) return 2;  // Broken line
      if (routeType.includes('Sub-warehouse to Satellite Warehouse')) return 2;  // Normal line
      if (routeType.includes('Sub-warehouse to Bin')) return 2;  // Broken line
      if (routeType.includes('Satellite Warehouse to Bin')) return 2;  // Broken line
      return 2;
    }

    function getMarkerSize(routeType) {
      if (routeType.includes('Cebu Main to Sub-warehouse')) return 6;  // Larger marker
      if (routeType.includes('Cebu Main to Bin')) return 4;  // Medium marker
      if (routeType.includes('Sub-warehouse to Satellite Warehouse')) return 4;  // Medium marker
      if (routeType.includes('Sub-warehouse to Bin')) return 4;  // Medium marker
      if (routeType.includes('Satellite Warehouse to Bin')) return 3;  // Smaller marker
      return 4;
    }
  </script>
</body>
</html>
